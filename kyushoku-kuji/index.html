<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãŠã‹ã‚ã‚Šãã˜</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'M PLUS Rounded 1c', sans-serif;
            background-color: #f0f9ff;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 1rem;
        }
        
        .ticket {
            transition: all 0.3s ease;
        }
        
        .ticket:hover:not(.disabled) {
            transform: translateY(-5px);
        }
        
        .ticket.disabled {
            opacity: 0.6;
            cursor: not-allowed;
            background-color: #f3f4f6; /* bg-gray-100 */
        }
        
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #f00;
            border-radius: 50%;
            animation: fall 3s ease-in infinite;
            z-index: 60;
        }
        
        @keyframes fall {
            0% {
                transform: translateY(-100px) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(500px) rotate(360deg);
                opacity: 0;
            }
        }
        
        .page {
            transition: opacity 0.5s ease, transform 0.5s ease;
            width: 100%;
        }
        
        .hidden-page {
            opacity: 0;
            transform: translateY(20px);
            pointer-events: none;
            position: absolute;
            height: 0;
            overflow: hidden;
        }
        
        .visible-page {
            opacity: 1;
            transform: translateY(0);
            position: relative;
            height: auto;
        }
        
        .food-emoji {
            font-size: 3rem;
            line-height: 1.2;
        }
        
        .result-emoji {
            font-size: 4rem;
            line-height: 1.2;
        }
        
        .winner-star {
            position: absolute;
            top: -5px;
            right: -5px;
            font-size: 2rem;
            color: gold;
            filter: drop-shadow(0 0 3px rgba(0,0,0,0.3));
            animation: pulse 1.5s infinite;
            z-index: 10;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        
        .message-box {
            border-radius: 20px;
            background: linear-gradient(145deg, #e6f5ff, #d1e6ff);
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
        }

        /* ã‚«ã‚¹ã‚¿ãƒ ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒ¼ */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8; 
        }
    </style>
</head>
<body>

    <!-- è¨­å®šãƒšãƒ¼ã‚¸ -->
    <div id="setupPage" class="page visible-page w-full max-w-md">
        <div class="bg-white rounded-xl shadow-lg p-8">
            <h1 class="text-3xl font-extrabold text-center text-blue-600 mb-2">ğŸš ãŠã‹ã‚ã‚Šãã˜ ğŸš</h1>
            <p class="text-center text-gray-500 mb-8 text-sm">èª°ãŒãŠã‹ã‚ã‚Šã™ã‚‹ã‹æ±ºã‚ã‚ˆã†ï¼</p>
            
            <div class="mb-6">
                <label class="block text-gray-700 text-sm font-bold mb-2" for="totalPeople">
                    å‚åŠ äººæ•°
                </label>
                <input id="totalPeople" type="number" min="1" value="5" 
                    class="shadow appearance-none border rounded-lg w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200">
            </div>
            
            <div class="mb-8">
                <label class="block text-gray-700 text-sm font-bold mb-2" for="winnerCount">
                    å½“ãŸã‚Šã®æ•°
                </label>
                <input id="winnerCount" type="number" min="1" value="2" 
                    class="shadow appearance-none border rounded-lg w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200">
            </div>
            
            <button id="generateBtn" class="w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-4 px-4 rounded-xl shadow-md transform hover:-translate-y-1 transition duration-200 flex items-center justify-center">
                <span class="mr-2">ğŸ²</span> ãã˜ã‚’ä½œæˆã™ã‚‹
            </button>
        </div>
    </div>
    
    <!-- ãã˜å¼•ããƒšãƒ¼ã‚¸ -->
    <div id="ticketsPage" class="page hidden-page w-full max-w-4xl flex flex-col items-center">
        <div class="w-full bg-white rounded-xl shadow-lg p-6 mb-8 text-center relative overflow-hidden">
            <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-blue-400 to-purple-500"></div>
            <h1 class="text-3xl font-bold text-center text-blue-600 mb-2">ã©ã‚Œã«ã™ã‚‹ï¼Ÿ</h1>
            <p class="text-gray-600">å¥½ããªé£Ÿã¹ç‰©ã‚’é¸ã‚“ã§ã‚¿ãƒƒãƒ—ã—ã¦ã­</p>
            <div class="mt-4 inline-block bg-red-100 text-red-600 px-4 py-1 rounded-full text-lg font-bold border border-red-200">
                <span id="remainingWinners"></span>
            </div>
        </div>
        
        <div id="ticketsContainer" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4 sm:gap-6 justify-items-center w-full">
            <!-- ãã˜ã¯ã“ã“ã«ç”Ÿæˆã•ã‚Œã¾ã™ -->
        </div>
        
        <div class="mt-10 flex flex-col sm:flex-row justify-center space-y-4 sm:space-y-0 sm:space-x-4 w-full max-w-md">
            <button id="showResultsBtn" class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-8 rounded-xl shadow-md transform hover:-translate-y-1 transition duration-200 flex-1">
                çµæœä¸€è¦§
            </button>
            <button id="resetBtn" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-8 rounded-xl shadow-md transform hover:-translate-y-1 transition duration-200 flex-1">
                æœ€åˆã«æˆ»ã‚‹
            </button>
        </div>
    </div>
    
    <!-- çµæœãƒ¢ãƒ¼ãƒ€ãƒ« (å€‹åˆ¥ã®ãã˜çµæœ) -->
    <div id="resultModal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 hidden backdrop-blur-sm transition-opacity duration-300">
        <div class="bg-white rounded-2xl p-8 max-w-sm w-full text-center relative shadow-2xl transform transition-all scale-100 mx-4">
            <button id="closeModal" class="absolute top-3 right-4 text-gray-400 hover:text-gray-600 text-2xl font-bold">&times;</button>
            <div id="resultContent" class="py-6 flex flex-col items-center"></div>
            <button id="okButton" class="mt-4 w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-xl shadow-lg transition duration-200">
                OK
            </button>
        </div>
    </div>
    
    <!-- æœ€çµ‚çµæœãƒ¢ãƒ¼ãƒ€ãƒ« (ä¸€è¦§) -->
    <div id="finalResultModal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 hidden backdrop-blur-sm">
        <div class="bg-white rounded-2xl p-6 sm:p-8 max-w-md w-full relative shadow-2xl mx-4 flex flex-col max-h-[90vh]">
            <button id="closeFinalModal" class="absolute top-3 right-4 text-gray-400 hover:text-gray-600 text-2xl font-bold">&times;</button>
            <h2 class="text-2xl font-bold text-center text-blue-600 mb-6 flex items-center justify-center">
                <span class="mr-2">ğŸ†</span> å½“ãŸã‚Šãã˜ã®çµæœ
            </h2>
            
            <div id="finalResultContent" class="py-2 overflow-y-auto flex-grow custom-scrollbar"></div>
            
            <div class="message-box mt-6 p-4 text-center bg-blue-50 border border-blue-200 rounded-xl">
                <p class="text-lg font-bold text-blue-800">ãŠã‚ã§ã¨ã†ï¼</p>
                <p class="text-sm text-blue-600 mt-1">ã¯ãšã‚ŒãŸäººã‚‚æ¬¡ã¯å½“ãŸã‚‹ã‹ã‚‚â€¦ï¼Ÿ</p>
            </div>
            
            <div class="mt-6 text-center">
                <button id="okFinalButton" class="w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-xl shadow-lg transition duration-200">
                    é–‰ã˜ã‚‹
                </button>
            </div>
        </div>
    </div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const setupPage = document.getElementById('setupPage');
        const ticketsPage = document.getElementById('ticketsPage');
        const totalPeopleInput = document.getElementById('totalPeople');
        const winnerCountInput = document.getElementById('winnerCount');
        const generateBtn = document.getElementById('generateBtn');
        const resetBtn = document.getElementById('resetBtn');
        const showResultsBtn = document.getElementById('showResultsBtn');
        const ticketsContainer = document.getElementById('ticketsContainer');
        const resultModal = document.getElementById('resultModal');
        const resultContent = document.getElementById('resultContent');
        const closeModal = document.getElementById('closeModal');
        const okButton = document.getElementById('okButton');
        const finalResultModal = document.getElementById('finalResultModal');
        const finalResultContent = document.getElementById('finalResultContent');
        const closeFinalModal = document.getElementById('closeFinalModal');
        const okFinalButton = document.getElementById('okFinalButton');
        const remainingWinners = document.getElementById('remainingWinners');
        
        let tickets = [];
        let winningTickets = [];
        let remainingWinnerCount = 0;
        let foodAssignments = [];
        
        // é£Ÿã¹ç‰©ã®çµµæ–‡å­—
        const foodEmojis = [
            { name: "ãŠã«ãã‚Š", emoji: "ğŸ™" },
            { name: "ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼", emoji: "ğŸ”" },
            { name: "ãƒ”ã‚¶", emoji: "ğŸ•" },
            { name: "ã‚¢ã‚¤ã‚¹ã‚¯ãƒªãƒ¼ãƒ ", emoji: "ğŸ¦" },
            { name: "ãƒ©ãƒ¼ãƒ¡ãƒ³", emoji: "ğŸœ" },
            { name: "ã™ã—", emoji: "ğŸ£" },
            { name: "ãƒ•ãƒ©ã‚¤ãƒ‰ãƒãƒ†ãƒˆ", emoji: "ğŸŸ" },
            { name: "ã‚±ãƒ¼ã‚­", emoji: "ğŸ°" },
            { name: "ãƒãƒ§ã‚³ãƒ¬ãƒ¼ãƒˆ", emoji: "ğŸ«" },
            { name: "ã‚«ãƒ¬ãƒ¼", emoji: "ğŸ›" },
            { name: "ãƒ‘ãƒ³", emoji: "ğŸ" },
            { name: "ãƒ‰ãƒ¼ãƒŠãƒ„", emoji: "ğŸ©" },
            { name: "ãŸã“ç„¼ã", emoji: "ğŸ™" },
            { name: "ã‚Šã‚“ã”", emoji: "ğŸ" },
            { name: "ãƒãƒŠãƒŠ", emoji: "ğŸŒ" },
            { name: "ã¿ã‹ã‚“", emoji: "ğŸŠ" },
            { name: "ã ã‚“ã”", emoji: "ğŸ¡" },
            { name: "ã‚¨ãƒ“ãƒ•ãƒ©ã‚¤", emoji: "ğŸ¤" },
            { name: "ã¹ã‚“ã¨ã†", emoji: "ğŸ±" },
            { name: "ãƒ—ãƒªãƒ³", emoji: "ğŸ®" }
        ];
        
        // çµæœã®çµµæ–‡å­—
        const resultEmojis = {
            win: "ğŸ˜†",  // å¬‰ã—ãã†ãªé¡”
            lose: "ğŸ¥º"  // æ‚²ã—ã„é¡”
        };
        
        generateBtn.addEventListener('click', startGame);
        resetBtn.addEventListener('click', resetGame);
        showResultsBtn.addEventListener('click', showFinalResults);
        closeModal.addEventListener('click', hideModal);
        okButton.addEventListener('click', hideModal);
        closeFinalModal.addEventListener('click', hideFinalModal);
        okFinalButton.addEventListener('click', hideFinalModal);
        
        // ãƒ¢ãƒ¼ãƒ€ãƒ«ã®èƒŒæ™¯ã‚¯ãƒªãƒƒã‚¯ã§ã‚‚é–‰ã˜ã‚‹ã‚ˆã†ã«
        resultModal.addEventListener('click', (e) => {
            if (e.target === resultModal) hideModal();
        });
        finalResultModal.addEventListener('click', (e) => {
            if (e.target === finalResultModal) hideFinalModal();
        });
        
        function startGame() {
            const totalPeople = parseInt(totalPeopleInput.value);
            const winnerCount = parseInt(winnerCountInput.value);
            
            if (isNaN(totalPeople) || totalPeople < 1) {
                alert('å‚åŠ äººæ•°ã¯1ä»¥ä¸Šã®æ•°å€¤ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }
            
            if (isNaN(winnerCount) || winnerCount < 1) {
                alert('å½“ãŸã‚Šã®æ•°ã¯1ä»¥ä¸Šã®æ•°å€¤ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }
            
            if (winnerCount > totalPeople) {
                alert('å½“ãŸã‚Šã®æ•°ã¯å‚åŠ äººæ•°ä»¥ä¸‹ã«ã—ã¦ãã ã•ã„');
                return;
            }
            
            // ãã˜ã‚’åˆæœŸåŒ–
            tickets = Array(totalPeople).fill(false);
            
            // å½“ãŸã‚Šãã˜ã‚’è¨­å®š
            winningTickets = [];
            while (winningTickets.length < winnerCount) {
                const randomIndex = Math.floor(Math.random() * totalPeople);
                if (!winningTickets.includes(randomIndex)) {
                    winningTickets.push(randomIndex);
                }
            }
            
            remainingWinnerCount = winnerCount;
            updateRemainingWinners();
            
            // é£Ÿã¹ç‰©çµµæ–‡å­—ã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã—ã¦å‰²ã‚Šå½“ã¦
            // å‚åŠ äººæ•°ãŒå¤šã„å ´åˆã¯çµµæ–‡å­—ãƒªã‚¹ãƒˆã‚’ãƒ«ãƒ¼ãƒ—ã—ã¦ä½¿ç”¨
            let availableFoods = [];
            while (availableFoods.length < totalPeople) {
                availableFoods = availableFoods.concat([...foodEmojis].sort(() => Math.random() - 0.5));
            }
            
            foodAssignments = [];
            
            for (let i = 0; i < totalPeople; i++) {
                foodAssignments.push({
                    index: i,
                    food: availableFoods[i],
                    isWinner: winningTickets.includes(i)
                });
            }
            
            // ãƒšãƒ¼ã‚¸åˆ‡ã‚Šæ›¿ãˆ
            setupPage.classList.remove('visible-page');
            setupPage.classList.add('hidden-page');
            
            ticketsPage.classList.remove('hidden-page');
            ticketsPage.classList.add('visible-page');
            
            renderTickets();
        }
        
        function resetGame() {
            // ãƒšãƒ¼ã‚¸åˆ‡ã‚Šæ›¿ãˆ
            ticketsPage.classList.remove('visible-page');
            ticketsPage.classList.add('hidden-page');
            
            setupPage.classList.remove('hidden-page');
            setupPage.classList.add('visible-page');
            
            // å°‘ã—é…å»¶ã•ã›ã¦ã‹ã‚‰åˆæœŸçŠ¶æ…‹ã«æˆ»ã™ï¼ˆã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®ãŸã‚ï¼‰
            setTimeout(() => {
                ticketsContainer.innerHTML = '';
            }, 500);
        }
        
        function renderTickets() {
            ticketsContainer.innerHTML = '';
            
            foodAssignments.forEach((item, index) => {
                const ticket = document.createElement('div');
                // ã‚¯ãƒ©ã‚¹åã‚’å‹•çš„ã«è¨­å®š
                const baseClasses = "ticket bg-white border-2 border-blue-200 rounded-2xl p-2 w-full h-40 flex flex-col items-center justify-center shadow-sm relative overflow-hidden";
                const stateClasses = tickets[index] 
                    ? 'disabled bg-gray-50' 
                    : 'cursor-pointer hover:border-blue-400 hover:shadow-md';
                
                ticket.className = `${baseClasses} ${stateClasses}`;
                
                // çµæœç¢ºèªãƒ¢ãƒ¼ãƒ‰ã§å½“ãŸã‚Šãã˜ã«æ˜Ÿãƒãƒ¼ã‚¯ã‚’è¡¨ç¤º
                if (item.isWinner && tickets[index]) {
                    ticket.classList.add('border-yellow-400', 'bg-yellow-50');
                    ticket.innerHTML = `
                        <div class="winner-star">â­</div>
                        <div class="text-center w-full z-10">
                            <div class="food-emoji mb-2 transform scale-110 transition-transform">${item.food.emoji}</div>
                            <div class="text-sm font-bold text-gray-500 mb-1">ãã˜ ${index + 1}</div>
                            <div class="text-lg font-black text-red-500">å½“ãŸã‚Šï¼</div>
                        </div>
                        <div class="absolute inset-0 bg-yellow-100 opacity-20 pointer-events-none"></div>
                    `;
                } else if (tickets[index]) {
                    // ã¯ãšã‚Œï¼ˆé–‹å°æ¸ˆã¿ï¼‰
                    ticket.innerHTML = `
                        <div class="text-center w-full opacity-70">
                            <div class="food-emoji mb-2 filter grayscale-[0.5] scale-90">${item.food.emoji}</div>
                            <div class="text-sm font-bold text-gray-400 mb-1">ãã˜ ${index + 1}</div>
                            <div class="text-md font-bold text-blue-400">ã¯ãšã‚Œ</div>
                        </div>
                    `;
                } else {
                    // æœªé–‹å°
                    ticket.innerHTML = `
                        <div class="text-center w-full">
                            <div class="food-emoji mb-2 animate-bounce-slow">${item.food.emoji}</div>
                            <div class="text-lg font-bold text-gray-700">ãã˜ ${index + 1}</div>
                            <div class="text-xs text-gray-400 mt-1">ã‚¿ãƒƒãƒ—ã—ã¦ã­</div>
                        </div>
                    `;
                }
                
                if (!tickets[index]) {
                    ticket.addEventListener('click', () => revealTicket(index));
                }
                
                ticketsContainer.appendChild(ticket);
            });
        }
        
        function revealTicket(index) {
            const isWinner = winningTickets.includes(index);
            
            // ãã˜ã‚’é–‹ã„ãŸçŠ¶æ…‹ã«ã™ã‚‹
            tickets[index] = true;
            
            if (isWinner) {
                remainingWinnerCount--;
                updateRemainingWinners();
            }
            
            resultContent.innerHTML = '';
            
            if (isWinner) {
                resultContent.innerHTML = `
                    <div class="text-4xl font-extrabold text-red-500 mb-2 drop-shadow-sm">å½“ãŸã‚Šï¼</div>
                    <div class="text-lg font-bold text-gray-700 mb-4">ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼</div>
                    <div class="result-emoji animate-pulse">${resultEmojis.win}</div>
                    <div class="text-5xl mt-4 animate-bounce">ğŸŠ</div>
                `;
                createConfetti();
            } else {
                resultContent.innerHTML = `
                    <div class="text-3xl font-bold text-blue-500 mb-2">ã¯ãšã‚Œ...</div>
                    <div class="text-lg text-gray-600 mb-4">ã©ã‚“ã¾ã„ï¼</div>
                    <div class="result-emoji">${resultEmojis.lose}</div>
                `;
            }
            
            resultModal.classList.remove('hidden');
            
            // ãã˜ã‚’å†æç”»
            renderTickets();
            
            // ã™ã¹ã¦ã®ãã˜ãŒé–‹ã‹ã‚ŒãŸã‚‰çµæœã‚’è¡¨ç¤º
            if (tickets.every(t => t === true)) {
                // å°‘ã—é•·ã‚ã«å¾…ã£ã¦ã‹ã‚‰æœ€çµ‚çµæœã‚’è¡¨ç¤º
                setTimeout(() => {
                    if(!resultModal.classList.contains('hidden')) {
                        hideModal();
                    }
                    showFinalResults();
                }, 2000);
            }
        }
        
        function showFinalResults() {
            finalResultContent.innerHTML = '';
            
            // å½“ãŸã‚Šãã˜ã®æƒ…å ±ã‚’è¡¨ç¤º
            const winnersList = document.createElement('div');
            winnersList.className = 'space-y-3';
            
            // å½“ãŸã‚Šãã˜ã®ä¸€è¦§
            let hasWinners = false;
            foodAssignments.forEach((item, index) => {
                if (item.isWinner) {
                    hasWinners = true;
                    const winnerItem = document.createElement('div');
                    winnerItem.className = 'bg-yellow-50 p-4 rounded-xl flex items-center justify-between border-2 border-yellow-200 shadow-sm';
                    winnerItem.innerHTML = `
                        <div class="flex items-center space-x-4">
                            <div class="text-4xl bg-white rounded-full p-2 shadow-sm">${item.food.emoji}</div>
                            <div class="text-left">
                                <div class="font-bold text-gray-800 text-lg">ãã˜ ${index + 1}</div>
                                <div class="text-sm text-gray-500 font-medium">${item.food.name}</div>
                            </div>
                        </div>
                        <div class="text-2xl animate-pulse">â­</div>
                    `;
                    winnersList.appendChild(winnerItem);
                }
            });
            
            // ã¾ã ãã˜ãŒå¼•ã‹ã‚Œã¦ã„ãªã„ï¼ˆã¾ãŸã¯å…¨éƒ¨å¤–ã‚ŒãŸï¼‰å ´åˆ
            // â€»ä»•æ§˜ä¸Šã€å½“ãŸã‚Šã¯å¿…ãšå­˜åœ¨ã—ã¾ã™ãŒã€åˆæœŸçŠ¶æ…‹ã§çµæœãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸå ´åˆãªã©ã®å¯¾å¿œ
            if (!hasWinners) {
                const noWinnersMsg = document.createElement('div');
                noWinnersMsg.className = 'text-center p-8 bg-gray-50 rounded-xl border border-dashed border-gray-300';
                noWinnersMsg.innerHTML = `
                    <div class="text-4xl mb-2">ğŸ¤”</div>
                    <div class="text-lg font-bold text-gray-500">ã¾ã å½“ãŸã‚ŠãŒå‡ºã¦ã„ã¾ã›ã‚“</div>
                `;
                winnersList.appendChild(noWinnersMsg);
            }
            
            finalResultContent.appendChild(winnersList);
            finalResultModal.classList.remove('hidden');
        }
        
        function updateRemainingWinners() {
            remainingWinners.textContent = `å½“ãŸã‚Šæ®‹ã‚Š: ${remainingWinnerCount}å€‹`;
        }
        
        function hideModal() {
            resultModal.classList.add('hidden');
            
            // ç´™å¹é›ªã‚’å‰Šé™¤ï¼ˆã‚‚ã—æ®‹ã£ã¦ã„ã‚Œã°ï¼‰
            const confettiContainer = resultModal.querySelector('.confetti-container');
            if (confettiContainer) {
                confettiContainer.remove();
            }
        }
        
        function hideFinalModal() {
            finalResultModal.classList.add('hidden');
        }
        
        function createConfetti() {
            // æ—¢å­˜ã®ç´™å¹é›ªã‚³ãƒ³ãƒ†ãƒŠãŒã‚ã‚Œã°å‰Šé™¤
            const existingContainer = resultModal.querySelector('.confetti-container');
            if (existingContainer) existingContainer.remove();

            const confettiContainer = document.createElement('div');
            confettiContainer.className = 'confetti-container';
            confettiContainer.style.position = 'absolute';
            confettiContainer.style.top = '0';
            confettiContainer.style.left = '0';
            confettiContainer.style.width = '100%';
            confettiContainer.style.height = '100%';
            confettiContainer.style.overflow = 'hidden';
            confettiContainer.style.pointerEvents = 'none';
            confettiContainer.style.zIndex = '100';
            confettiContainer.style.borderRadius = '1rem'; // ãƒ¢ãƒ¼ãƒ€ãƒ«ã®è§’ä¸¸ã«åˆã‚ã›ã‚‹
            
            const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff'];
            
            for (let i = 0; i < 60; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + '%';
                // é–‹å§‹ä½ç½®ã‚’å°‘ã—ã°ã‚‰ã¤ã‹ã›ã‚‹
                confetti.style.top = -20 + 'px';
                
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                
                const size = Math.random() * 8 + 6;
                confetti.style.width = size + 'px';
                confetti.style.height = size + 'px';
                
                // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š
                confetti.style.animationDelay = Math.random() * 1 + 's';
                confetti.style.animationDuration = Math.random() * 2 + 1.5 + 's';
                
                confettiContainer.appendChild(confetti);
            }
            
            resultModal.querySelector('.bg-white').appendChild(confettiContainer);
            
            setTimeout(() => {
                confettiContainer.remove();
            }, 5000);
        }
    });
</script>
</body>
</html>