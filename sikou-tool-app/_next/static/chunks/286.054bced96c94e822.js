"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[286],{7286:(e,t,r)=>{r.r(t),r.d(t,{default:()=>f});var i=r(5155),s=r(2115),n=r(944),a=r(9869),l=r(6283);let d={yellow:"#fef08a",blue:"#bfdbfe",green:"#bbf7d0",pink:"#fbcfe8",purple:"#e9d5ff"},o=["yellow","blue","green","pink","purple"];function h(e){let{node:t,isSelected:r}=e,{updateNode:h,setSelectedNodes:c,removeNode:x,addConnectedNode:u}=(0,a.F)(),[g,f]=(0,s.useState)(!1),[b,y]=(0,s.useState)(t.text),w=(0,s.useRef)(null),j=(0,s.useRef)(null),p=(0,s.useRef)(null);(0,s.useEffect)(()=>{g&&w.current&&setTimeout(()=>{var e,t,r,i;null==(e=w.current)||e.focus(),null==(i=w.current)||i.setSelectionRange((null==(t=w.current)?void 0:t.value.length)||0,(null==(r=w.current)?void 0:r.value.length)||0)},50)},[g]),(0,s.useEffect)(()=>{r&&p.current&&j.current&&(p.current.nodes([j.current]),p.current.getLayer().batchDraw())},[r]);let k=(0,s.useRef)({x:t.x,y:t.y}),m=()=>{if(f(!1),w.current){let e=w.current.value;y(e),h(t.id,{text:e})}};return(0,i.jsxs)(s.Fragment,{children:[(0,i.jsxs)(n.YJ,{id:t.id,ref:j,x:t.x,y:t.y,draggable:!0,onDragStart:e=>{k.current={x:e.target.x(),y:e.target.y()}},onDragMove:e=>{if(r){let r=e.target.x()-k.current.x,i=e.target.y()-k.current.y;a.F.getState().moveSelectedNodes(r,i,t.id),k.current={x:e.target.x(),y:e.target.y()}}},onDragEnd:e=>{h(t.id,{x:e.target.x(),y:e.target.y()})},onClick:e=>{e.cancelBubble=!0,c([t.id])},onDblClick:e=>{e.cancelBubble=!0,f(!0)},onTransformEnd:e=>{let r=j.current,i=r.scaleX(),s=r.scaleY();r.scaleX(1),r.scaleY(1),h(t.id,{x:r.x(),y:r.y(),width:Math.max(50,t.width*i),height:Math.max(50,t.height*s)})},children:[(0,i.jsx)(n.rw,{width:t.width,height:t.height,fill:d[t.color],shadowColor:"black",shadowBlur:10,shadowOpacity:.1,shadowOffset:{x:2,y:2},cornerRadius:4,stroke:r?"#3b82f6":"transparent",strokeWidth:2*!!r}),g?(0,i.jsx)(n.YJ,{x:12,y:12,children:(0,i.jsx)(l.Ed,{children:(0,i.jsx)("textarea",{ref:w,autoFocus:!0,defaultValue:b,onBlur:m,onKeyDown:e=>{"Escape"===e.key&&m()},className:"bg-transparent border-none outline-none resize-none text-center text-slate-800 text-base p-1",style:{width:"".concat(t.width-24,"px"),height:"".concat(t.height-24,"px"),fontFamily:"sans-serif"},placeholder:"テキストを入力..."})})}):(0,i.jsx)(n.EY,{text:t.text||"ダブルクリックで入力",width:t.width-24,height:t.height-24,x:12,y:12,fontSize:16,fontFamily:"sans-serif",fill:t.text?"#1e293b":"#94a3b8",wrap:"word",align:"center",verticalAlign:"middle"}),r&&(0,i.jsxs)(s.Fragment,{children:[(0,i.jsx)(n.YJ,{x:0,y:-40,children:(0,i.jsx)(l.Ed,{children:(0,i.jsx)("button",{onClick:e=>{e.stopPropagation(),u(t.id)},className:"px-3 py-1.5 bg-blue-500 text-white text-xs font-bold rounded-full shadow-md hover:bg-blue-600 transition-colors whitespace-nowrap",children:"繋げる →"})})}),(0,i.jsx)(n.YJ,{x:t.width+15,y:-15,children:(0,i.jsx)(l.Ed,{children:(0,i.jsx)("button",{onClick:e=>{e.stopPropagation(),x(t.id)},className:"w-8 h-8 bg-red-500 text-white rounded-full flex items-center justify-center shadow-md hover:bg-red-600 transition-colors text-lg",style:{transform:"translate(-50%, -50%)"},title:"削除",children:"\xd7"})})}),(0,i.jsx)(n.YJ,{x:t.width/2,y:t.height+15,children:(0,i.jsx)(l.Ed,{children:(0,i.jsx)("div",{className:"flex gap-1 bg-white p-1.5 rounded-full shadow-md border border-slate-200",style:{transform:"translate(-50%, 0)"},children:o.map(e=>(0,i.jsx)("button",{onClick:r=>{r.stopPropagation(),h(t.id,{color:e})},className:"w-6 h-6 rounded-full border ".concat(t.color===e?"border-slate-800 scale-110":"border-transparent"),style:{backgroundColor:d[e]},title:"".concat(e,"に変更")},e))})})})]})]}),r&&(0,i.jsx)(n.Ge,{ref:p,boundBoxFunc:(e,t)=>t.width<50||t.height<50?e:t})]})}function c(e){let{template:t}=e,{type:r,x:d,y:o,width:h,height:c,id:x}=t,{updateTemplate:u,selectedTemplateIds:g,setSelectedTemplates:f,removeTemplate:b}=(0,a.F)(),y=g.includes(x),w=(0,s.useRef)(null),j=(0,s.useRef)(null);(0,s.useEffect)(()=>{y&&j.current&&w.current&&(j.current.nodes([w.current]),j.current.getLayer().batchDraw())},[y]);let p=(0,s.useRef)({x:d,y:o});return(0,i.jsxs)(s.Fragment,{children:[(0,i.jsxs)(n.YJ,{id:x,ref:w,x:d,y:o,width:h,height:c,draggable:!0,onDragStart:e=>{p.current={x:e.target.x(),y:e.target.y()}},onDragMove:e=>{if(y){let t=e.target.x()-p.current.x,r=e.target.y()-p.current.y;a.F.getState().moveSelectedNodes(t,r,x),p.current={x:e.target.x(),y:e.target.y()}}},onDragEnd:e=>{u(x,{x:e.target.x(),y:e.target.y()})},onClick:e=>{e.cancelBubble=!0,f([x])},onTransformEnd:e=>{let t=w.current,r=t.scaleX(),i=t.scaleY();t.scaleX(1),t.scaleY(1),u(x,{x:t.x(),y:t.y(),width:Math.max(50,t.width()*r),height:Math.max(50,t.height()*i)})},children:[(0,i.jsx)(n.rw,{width:h,height:c,fill:"transparent"}),(()=>{switch(r){case"x":return(0,i.jsxs)(n.YJ,{children:[(0,i.jsx)(n.rw,{width:h,height:c,stroke:"#cbd5e1",strokeWidth:2,fill:"rgba(203, 213, 225, 0.05)"}),(0,i.jsx)(n.N1,{points:[0,0,h,c],stroke:"#94a3b8",strokeWidth:4}),(0,i.jsx)(n.N1,{points:[h,0,0,c],stroke:"#94a3b8",strokeWidth:4})]});case"y":return(0,i.jsxs)(n.YJ,{children:[(0,i.jsx)(n.rw,{width:h,height:c,stroke:"#cbd5e1",strokeWidth:2,fill:"rgba(203, 213, 225, 0.05)"}),(0,i.jsx)(n.N1,{points:[0,0,h/2,c/2],stroke:"#94a3b8",strokeWidth:4}),(0,i.jsx)(n.N1,{points:[h,0,h/2,c/2],stroke:"#94a3b8",strokeWidth:4}),(0,i.jsx)(n.N1,{points:[h/2,c/2,h/2,c],stroke:"#94a3b8",strokeWidth:4})]});case"axis":return(0,i.jsxs)(n.YJ,{children:[(0,i.jsx)(n.N1,{points:[h/2,0,h/2,c],stroke:"#94a3b8",strokeWidth:4}),(0,i.jsx)(n.N1,{points:[0,c/2,h,c/2],stroke:"#94a3b8",strokeWidth:4}),(0,i.jsx)(n.N1,{points:[h/2-10,10,h/2,0,h/2+10,10],stroke:"#94a3b8",strokeWidth:4}),(0,i.jsx)(n.N1,{points:[h-10,c/2-10,h,c/2,h-10,c/2+10],stroke:"#94a3b8",strokeWidth:4})]});case"venn":return(0,i.jsxs)(n.YJ,{children:[(0,i.jsx)(n.jl,{x:h/3,y:c/2,radius:Math.min(h,c)/2.5,stroke:"#cbd5e1",strokeWidth:4,fill:"rgba(203, 213, 225, 0.1)"}),(0,i.jsx)(n.jl,{x:h/3*2,y:c/2,radius:Math.min(h,c)/2.5,stroke:"#cbd5e1",strokeWidth:4,fill:"rgba(203, 213, 225, 0.1)"})]});case"pmi":return(0,i.jsxs)(n.YJ,{children:[(0,i.jsx)(n.rw,{x:0,y:0,width:h/3,height:c,stroke:"#cbd5e1",strokeWidth:2,fill:"rgba(203, 213, 225, 0.05)"}),(0,i.jsx)(n.rw,{x:h/3,y:0,width:h/3,height:c,stroke:"#cbd5e1",strokeWidth:2,fill:"rgba(203, 213, 225, 0.05)"}),(0,i.jsx)(n.rw,{x:h/3*2,y:0,width:h/3,height:c,stroke:"#cbd5e1",strokeWidth:2,fill:"rgba(203, 213, 225, 0.05)"}),(0,i.jsx)(n.EY,{x:0,y:20,width:h/3,text:"Plus (良い点)",fontSize:Math.max(16,.025*h),fill:"#64748b",align:"center"}),(0,i.jsx)(n.EY,{x:h/3,y:20,width:h/3,text:"Minus (悪い点)",fontSize:Math.max(16,.025*h),fill:"#64748b",align:"center"}),(0,i.jsx)(n.EY,{x:h/3*2,y:20,width:h/3,text:"Interesting (興味深い点)",fontSize:Math.max(16,.025*h),fill:"#64748b",align:"center"})]});case"kwl":return(0,i.jsxs)(n.YJ,{children:[(0,i.jsx)(n.rw,{x:0,y:0,width:h/3,height:c,stroke:"#cbd5e1",strokeWidth:2,fill:"rgba(203, 213, 225, 0.05)"}),(0,i.jsx)(n.rw,{x:h/3,y:0,width:h/3,height:c,stroke:"#cbd5e1",strokeWidth:2,fill:"rgba(203, 213, 225, 0.05)"}),(0,i.jsx)(n.rw,{x:h/3*2,y:0,width:h/3,height:c,stroke:"#cbd5e1",strokeWidth:2,fill:"rgba(203, 213, 225, 0.05)"}),(0,i.jsx)(n.EY,{x:0,y:20,width:h/3,text:"K (知っていること)",fontSize:Math.max(16,.025*h),fill:"#64748b",align:"center"}),(0,i.jsx)(n.EY,{x:h/3,y:20,width:h/3,text:"W (知りたいこと)",fontSize:Math.max(16,.025*h),fill:"#64748b",align:"center"}),(0,i.jsx)(n.EY,{x:h/3*2,y:20,width:h/3,text:"L (わかったこと)",fontSize:Math.max(16,.025*h),fill:"#64748b",align:"center"})]});case"jellyfish":{let e=.5*h,t=e/2+.05*c,r=.25*h,a=.05*c,l=a+t,d=.85*c,o=.08*h,x=[.25*h,.375*h,.5*h,.625*h,.75*h],u=[.1*h,.3*h,.5*h,.7*h,.9*h];return(0,i.jsxs)(n.YJ,{children:[(0,i.jsx)(n.rw,{x:r,y:a,width:e,height:t,cornerRadius:[e/2,e/2,0,0],stroke:"#cbd5e1",strokeWidth:4,fill:"rgba(203, 213, 225, 0.1)"}),[0,1,2,3,4].map(e=>{let t=x[e],r=u[e],a=Math.atan2(d-l,r-t),h=r-o*Math.cos(a),c=d-o*Math.sin(a);return(0,i.jsxs)(s.Fragment,{children:[(0,i.jsx)(n.N1,{points:[t,l,h,c],stroke:"#cbd5e1",strokeWidth:4}),(0,i.jsx)(n.jl,{x:r,y:d,radius:o,stroke:"#cbd5e1",strokeWidth:4,fill:"rgba(203, 213, 225, 0.05)"})]},e)})]})}case"fishbone":{let e=.25*h,t=.5*c,r=.75*h,s=.25*c,a=.35*h,l=.7*h,d=.15*h,o=.4*c,x=a-d,u=l-d;return(0,i.jsxs)(n.YJ,{children:[(0,i.jsx)(n.N1,{points:[0,c/2,r,c/2],stroke:"#cbd5e1",strokeWidth:4}),(0,i.jsx)(n.rw,{x:r,y:s,width:e,height:t,cornerRadius:[0,t/2,t/2,0],stroke:"#cbd5e1",strokeWidth:4,fill:"rgba(203, 213, 225, 0.1)"}),(0,i.jsx)(n.N1,{points:[a,c/2,x,c/2-o,0,c/2-o],stroke:"#cbd5e1",strokeWidth:4}),(0,i.jsx)(n.N1,{points:[a,c/2,x,c/2+o,0,c/2+o],stroke:"#cbd5e1",strokeWidth:4}),(0,i.jsx)(n.N1,{points:[l,c/2,u,c/2-o,a,c/2-o],stroke:"#cbd5e1",strokeWidth:4}),(0,i.jsx)(n.N1,{points:[l,c/2,u,c/2+o,a,c/2+o],stroke:"#cbd5e1",strokeWidth:4})]})}case"candy":return(0,i.jsxs)(n.YJ,{children:[(0,i.jsx)(n.jl,{x:h/2,y:c/2,radius:.3*Math.min(h,c),stroke:"#cbd5e1",strokeWidth:4,fill:"rgba(203, 213, 225, 0.1)"}),(0,i.jsx)(n.N1,{points:[h/2-.3*Math.min(h,c),c/2,0,.2*c,0,.8*c],closed:!0,stroke:"#cbd5e1",strokeWidth:4,fill:"rgba(203, 213, 225, 0.05)"}),(0,i.jsx)(n.N1,{points:[h/2+.3*Math.min(h,c),c/2,h,.2*c,h,.8*c],closed:!0,stroke:"#cbd5e1",strokeWidth:4,fill:"rgba(203, 213, 225, 0.05)"})]});case"pyramid":return(0,i.jsxs)(n.YJ,{children:[(0,i.jsx)(n.N1,{points:[h/2,0,h,c,0,c],closed:!0,stroke:"#cbd5e1",strokeWidth:4,fill:"rgba(203, 213, 225, 0.1)"}),(0,i.jsx)(n.N1,{points:[.33*h,.33*c,.67*h,.33*c],stroke:"#cbd5e1",strokeWidth:4}),(0,i.jsx)(n.N1,{points:[.16*h,.66*c,.84*h,.66*c],stroke:"#cbd5e1",strokeWidth:4})]});default:return(0,i.jsx)(n.rw,{width:h,height:c,stroke:"#cbd5e1",strokeWidth:2,dash:[10,5]})}})(),y&&(0,i.jsx)(l.Ed,{divProps:{style:{position:"absolute",top:-20,left:h-20}},children:(0,i.jsx)("button",{onClick:e=>{e.stopPropagation(),b(x)},className:"w-12 h-12 bg-red-500 text-white rounded-full flex items-center justify-center shadow-md hover:bg-red-600 transition-colors text-2xl z-50 hover:scale-110",title:"削除",children:"\xd7"})})]}),y&&(0,i.jsx)(n.Ge,{ref:j,boundBoxFunc:(e,t)=>t.width<50||t.height<50?e:t})]})}function x(e){let{edge:t}=e,{nodes:r}=(0,a.F)(),s=r.find(e=>e.id===t.sourceId),l=r.find(e=>e.id===t.targetId);if(!s||!l)return null;let d=s.x+s.width/2,o=s.y+s.height/2,h=l.x+l.width/2,c=l.y+l.height/2;return(0,i.jsx)(n.N1,{points:[d,o,h,c],stroke:"#94a3b8",strokeWidth:3,dash:[10,5]})}function u(e){let{node:t,isSelected:r}=e,{updateImage:d,setSelectedNodes:o,removeImage:h}=(0,a.F)(),c=(0,s.useRef)(null),x=(0,s.useRef)(null),[u,g]=(0,s.useState)(null);(0,s.useEffect)(()=>{let e=new window.Image;e.src=t.src,e.onload=()=>g(e)},[t.src]),(0,s.useEffect)(()=>{r&&x.current&&c.current&&(x.current.nodes([c.current]),x.current.getLayer().batchDraw())},[r]);let f=(0,s.useRef)({x:t.x,y:t.y});return(0,i.jsxs)(s.Fragment,{children:[(0,i.jsxs)(n.YJ,{id:t.id,ref:c,x:t.x,y:t.y,draggable:!0,onDragStart:e=>{f.current={x:e.target.x(),y:e.target.y()}},onDragMove:e=>{if(r){let r=e.target.x()-f.current.x,i=e.target.y()-f.current.y;a.F.getState().moveSelectedNodes(r,i,t.id),f.current={x:e.target.x(),y:e.target.y()}}},onClick:e=>{e.cancelBubble=!0,o([t.id])},onDragEnd:e=>d(t.id,{x:e.target.x(),y:e.target.y()}),onTransformEnd:e=>{let r=c.current,i=r.scaleX(),s=r.scaleY();r.scaleX(1),r.scaleY(1),d(t.id,{x:r.x(),y:r.y(),width:Math.max(20,t.width*i),height:Math.max(20,t.height*s)})},children:[(0,i.jsx)(n._V,{image:u||void 0,width:t.width,height:t.height}),r&&(0,i.jsx)(l.Ed,{divProps:{style:{position:"absolute",top:-15,left:t.width-15}},children:(0,i.jsx)("button",{onClick:e=>{e.stopPropagation(),h(t.id)},className:"w-8 h-8 bg-red-500 text-white rounded-full flex items-center justify-center shadow-md hover:bg-red-600 text-lg z-50",children:"\xd7"})})]}),r&&(0,i.jsx)(n.Ge,{ref:x,boundBoxFunc:(e,t)=>t.width<20||t.height<20?e:t})]})}function g(e){let{node:t,isSelected:r}=e,{updateText:d,setSelectedNodes:o,removeText:h}=(0,a.F)(),[c,x]=(0,s.useState)(!1),[u,g]=(0,s.useState)(t.text),f=(0,s.useRef)(null),b=(0,s.useRef)(null),y=(0,s.useRef)(null);(0,s.useEffect)(()=>{c&&f.current&&setTimeout(()=>{var e,t,r,i;null==(e=f.current)||e.focus(),null==(i=f.current)||i.setSelectionRange((null==(t=f.current)?void 0:t.value.length)||0,(null==(r=f.current)?void 0:r.value.length)||0)},50)},[c]),(0,s.useEffect)(()=>{r&&y.current&&b.current&&(y.current.nodes([b.current]),y.current.getLayer().batchDraw())},[r]);let w=(0,s.useRef)({x:t.x,y:t.y});return(0,i.jsxs)(s.Fragment,{children:[(0,i.jsxs)(n.YJ,{id:t.id,ref:b,x:t.x,y:t.y,draggable:!0,onDragStart:e=>{w.current={x:e.target.x(),y:e.target.y()}},onDragMove:e=>{if(r){let r=e.target.x()-w.current.x,i=e.target.y()-w.current.y;a.F.getState().moveSelectedNodes(r,i,t.id),w.current={x:e.target.x(),y:e.target.y()}}},onClick:e=>{e.cancelBubble=!0,o([t.id])},onDblClick:e=>{e.cancelBubble=!0,x(!0)},onDragEnd:e=>d(t.id,{x:e.target.x(),y:e.target.y()}),onTransformEnd:e=>{let r=b.current,i=r.scaleX(),s=r.scaleY();r.scaleX(1),r.scaleY(1),d(t.id,{x:r.x(),y:r.y(),width:Math.max(50,t.width*i),fontSize:Math.max(12,t.fontSize*s)})},children:[c?(0,i.jsx)(l.Ed,{divProps:{style:{position:"absolute",top:0,left:0}},children:(0,i.jsx)("textarea",{ref:f,autoFocus:!0,defaultValue:u,onBlur:()=>{if(x(!1),f.current){let e=f.current.value;g(e),d(t.id,{text:e})}},onKeyDown:e=>{if("Escape"===e.key&&(x(!1),f.current)){let e=f.current.value;g(e),d(t.id,{text:e})}},className:"bg-white/80 backdrop-blur-sm border border-blue-400 outline-none resize-none text-slate-800 rounded-md shadow-sm",style:{fontSize:"".concat(t.fontSize,"px"),width:"".concat(Math.max(t.width,200),"px"),minHeight:"50px",padding:"10px"},placeholder:"テキストを入力..."})}):(0,i.jsx)(n.EY,{text:t.text||"ダブルクリックでテキスト入力",fontSize:t.fontSize,fontFamily:"sans-serif",fill:"#1e293b",width:Math.max(t.width,200),padding:10}),r&&!c&&(0,i.jsx)(l.Ed,{divProps:{style:{position:"absolute",top:-15,left:Math.max(t.width,200)-15}},children:(0,i.jsx)("button",{onClick:e=>{e.stopPropagation(),h(t.id)},className:"w-8 h-8 bg-red-500 text-white rounded-full flex items-center justify-center shadow-md hover:bg-red-600 text-lg z-50",children:"\xd7"})})]}),r&&!c&&(0,i.jsx)(n.Ge,{ref:y,boundBoxFunc:(e,t)=>t.width<50||t.height<12?e:t})]})}function f(){let{tool:e,nodes:t,images:r,texts:l,templates:d,edges:o,addNode:f,setCanvasTransform:b,canvasScale:y,canvasPosition:w,setSelectedNodes:j,selectedNodeIds:p,selectedTemplateIds:k,setMultiSelection:m}=(0,a.F)(),[S,M]=(0,s.useState)({width:0,height:0}),[v,E]=(0,s.useState)(null),[W,N]=(0,s.useState)(!1),Y=(0,s.useRef)(null),F=(0,s.useRef)(null);(0,s.useEffect)(()=>{if(Y.current&&F.current){let e=[...p,...k];if(e.length>1){let t=e.map(e=>F.current.findOne("#"+e)).filter(Boolean);Y.current.nodes(t),Y.current.getLayer().batchDraw()}else Y.current.nodes([])}},[p,k]),(0,s.useEffect)(()=>{let e=()=>{M({width:window.innerWidth,height:window.innerHeight})};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let D=e=>{let t=e.getPointerPosition();return{x:(t.x-w.x)/y,y:(t.y-w.y)/y}};return 0===S.width?null:(0,i.jsx)("div",{className:"w-full h-full bg-slate-50 overflow-hidden",style:{cursor:"grab"},children:(0,i.jsx)(n.BI,{width:S.width,height:S.height,onWheel:e=>{e.evt.preventDefault();let t=e.target.getStage(),r=t.scaleX(),i={x:t.getPointerPosition().x/r-t.x()/r,y:t.getPointerPosition().y/r-t.y()/r},s=e.evt.deltaY<0?1.1*r:r/1.1;s<.1||s>5||b(s,{x:-(i.x-t.getPointerPosition().x/s)*s,y:-(i.y-t.getPointerPosition().y/s)*s})},draggable:"pointer"===e,x:w.x,y:w.y,scaleX:y,scaleY:y,onDragEnd:e=>{e.target===e.target.getStage()&&b(y,{x:e.target.x(),y:e.target.y()})},onClick:e=>{e.target!==e.target.getStage()||W||m([],[])},onDblClick:e=>{if(e.target===e.target.getStage()){let t=e.target.getStage().getPointerPosition();f((t.x-w.x)/y,(t.y-w.y)/y)}},onMouseDown:t=>{if("lasso"===e&&t.target===t.target.getStage()){N(!0);let e=D(t.target.getStage());E({x:e.x,y:e.y,width:0,height:0})}},onMouseMove:e=>{if(W&&v){let t=D(e.target.getStage());E({...v,width:t.x-v.x,height:t.y-v.y})}},onMouseUp:e=>{if(W&&v){N(!1);let e={x:Math.min(v.x,v.x+v.width),y:Math.min(v.y,v.y+v.height),width:Math.abs(v.width),height:Math.abs(v.height)};if(e.width<5||e.height<5)return void E(null);let i=t=>!(t.x>e.x+e.width||t.x+t.width<e.x||t.y>e.y+e.height||t.y+t.height<e.y),s=[],n=[];t.forEach(e=>{i(e)&&s.push(e.id)}),r.forEach(e=>{i(e)&&s.push(e.id)}),l.forEach(e=>{i(e)&&s.push(e.id)}),d.forEach(e=>{i(e)&&n.push(e.id)}),m(s,n),E(null)}},children:(0,i.jsxs)(n.Wd,{ref:F,children:[d.map(e=>(0,i.jsx)(c,{template:e},e.id)),r.map(e=>(0,i.jsx)(u,{node:e,isSelected:p.includes(e.id)},e.id)),l.map(e=>(0,i.jsx)(g,{node:e,isSelected:p.includes(e.id)},e.id)),o.map(e=>(0,i.jsx)(x,{edge:e},e.id)),t.map(e=>(0,i.jsx)(h,{node:e,isSelected:p.includes(e.id)},e.id)),v&&(0,i.jsx)(n.rw,{x:v.x,y:v.y,width:v.width,height:v.height,fill:"rgba(59, 130, 246, 0.1)",stroke:"#3b82f6",strokeWidth:1/y}),p.length+k.length>1&&(0,i.jsx)(n.Ge,{ref:Y,boundBoxFunc:(e,t)=>t.width<50||t.height<50?e:t,onTransformEnd:e=>{let t=[...p,...k],r=a.F.getState();t.forEach(e=>{let t=F.current.findOne("#"+e);if(t){let i=Math.abs(t.scaleX()),s=Math.abs(t.scaleY());t.scaleX(1),t.scaleY(1);let n=r.nodes.find(t=>t.id===e),a=r.images.find(t=>t.id===e),l=r.texts.find(t=>t.id===e),d=r.templates.find(t=>t.id===e);n?r.updateNode(e,{x:t.x(),y:t.y(),width:Math.max(50,n.width*i),height:Math.max(50,n.height*s)}):a?r.updateImage(e,{x:t.x(),y:t.y(),width:Math.max(20,a.width*i),height:Math.max(20,a.height*s)}):l?r.updateText(e,{x:t.x(),y:t.y(),width:Math.max(50,l.width*i),fontSize:Math.max(12,l.fontSize*i)}):d&&r.updateTemplate(e,{x:t.x(),y:t.y(),width:Math.max(50,d.width*i),height:Math.max(50,d.height*s)})}})}})]})})})}}}]);