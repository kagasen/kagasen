(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{4685:(e,t,s)=>{"use strict";s.d(t,{Sidebar:()=>F});var a=s(5155),d=s(2115),i=s(9869),n=s(3101),l=s(2467),o=s(2821),r=s(5889);function c(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.QP)((0,o.$)(t))}let u=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",xs:"h-6 gap-1 rounded-md px-2 text-xs has-[>svg]:px-1.5 [&_svg:not([class*='size-'])]:size-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9","icon-xs":"size-6 rounded-md [&_svg:not([class*='size-'])]:size-3","icon-sm":"size-8","icon-lg":"size-10"}},defaultVariants:{variant:"default",size:"default"}});function m(e){let{className:t,variant:s="default",size:d="default",asChild:i=!1,...n}=e,o=i?l.bL:"button";return(0,a.jsx)(o,{"data-slot":"button","data-variant":s,"data-size":d,className:c(u({variant:s,size:d,className:t})),...n})}var x=s(5740),g=s(8597),h=s(3606),p=s(6826),v=s(583),f=s(2196),b=s(878),j=s(9867),w=s(1360),N=s(9227);function y(e){let{...t}=e;return(0,a.jsx)(N.bL,{"data-slot":"dropdown-menu",...t})}function k(e){let{...t}=e;return(0,a.jsx)(N.l9,{"data-slot":"dropdown-menu-trigger",...t})}function I(e){let{className:t,sideOffset:s=4,...d}=e;return(0,a.jsx)(N.ZL,{children:(0,a.jsx)(N.UC,{"data-slot":"dropdown-menu-content",sideOffset:s,className:c("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",t),...d})})}function C(e){let{className:t,inset:s,variant:d="default",...i}=e;return(0,a.jsx)(N.q7,{"data-slot":"dropdown-menu-item","data-inset":s,"data-variant":d,className:c("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...i})}var z=s(5229),A=s(9511);function _(e){let{...t}=e;return(0,a.jsx)(A.bL,{"data-slot":"dialog",...t})}function T(e){let{...t}=e;return(0,a.jsx)(A.ZL,{"data-slot":"dialog-portal",...t})}function S(e){let{className:t,...s}=e;return(0,a.jsx)(A.hJ,{"data-slot":"dialog-overlay",className:c("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...s})}function P(e){let{className:t,children:s,showCloseButton:d=!0,...i}=e;return(0,a.jsxs)(T,{"data-slot":"dialog-portal",children:[(0,a.jsx)(S,{}),(0,a.jsxs)(A.UC,{"data-slot":"dialog-content",className:c("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 outline-none sm:max-w-lg",t),...i,children:[s,d&&(0,a.jsxs)(A.bm,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,a.jsx)(z.A,{}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function R(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"dialog-header",className:c("flex flex-col gap-2 text-center sm:text-left",t),...s})}function L(e){let{className:t,...s}=e;return(0,a.jsx)(A.hE,{"data-slot":"dialog-title",className:c("text-lg leading-none font-semibold",t),...s})}function E(e){let{className:t,...s}=e;return(0,a.jsx)(A.VY,{"data-slot":"dialog-description",className:c("text-muted-foreground text-sm",t),...s})}var W=s(8720);function F(){let{tool:e,setTool:t,addNode:s,addTemplate:n,resetCanvas:l,addImage:o,addText:r}=(0,i.F)(),[c,u]=(0,d.useState)(!1),N=e=>{n(e),W.oR.success("テンプレートを追加しました")};return(0,a.jsxs)("div",{className:"w-64 bg-white border-r border-slate-200 h-full flex flex-col p-4 shadow-sm z-10",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsxs)("h1",{className:"text-xl font-bold text-slate-800 flex items-center gap-2",children:[(0,a.jsx)(x.A,{className:"w-6 h-6 text-blue-500"}),"思考ツール"]}),(0,a.jsx)("p",{className:"text-sm text-slate-500 mt-1",children:"考えを整理しよう"})]}),(0,a.jsx)("div",{className:"flex flex-col gap-4 flex-1",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h2",{className:"text-sm font-semibold text-slate-700 uppercase tracking-wider",children:"操作モード"}),(0,a.jsxs)("div",{className:"flex flex-col gap-2 mb-4",children:[(0,a.jsxs)(m,{onClick:()=>t("pointer"),variant:"pointer"===e?"default":"outline",className:"w-full justify-start gap-2 ".concat("pointer"===e?"bg-slate-800 text-white":"text-slate-600"),children:[(0,a.jsx)(g.A,{className:"w-4 h-4"}),"選択・移動"]}),(0,a.jsxs)(m,{onClick:()=>t("lasso"),variant:"lasso"===e?"default":"outline",className:"w-full justify-start gap-2 ".concat("lasso"===e?"bg-blue-600 text-white":"text-slate-600"),children:[(0,a.jsx)(h.A,{className:"w-4 h-4"}),"囲んで選択"]})]}),(0,a.jsx)("h2",{className:"text-sm font-semibold text-slate-700 uppercase tracking-wider mt-6",children:"追加ツール"}),(0,a.jsxs)(m,{onClick:()=>{s(window.innerWidth/2-75,window.innerHeight/2-75),W.oR.success("ふせんを追加しました")},className:"w-full justify-start gap-2 bg-blue-50 hover:bg-blue-100 text-blue-700 border-blue-200",variant:"outline",children:[(0,a.jsx)(p.A,{className:"w-4 h-4"}),"ふせんを追加"]}),(0,a.jsxs)(m,{onClick:()=>{r(window.innerWidth/2-100,window.innerHeight/2-25),W.oR.success("テキストを追加しました")},className:"w-full justify-start gap-2 bg-purple-50 hover:bg-purple-100 text-purple-700 border-purple-200",variant:"outline",children:[(0,a.jsx)(v.A,{className:"w-4 h-4"}),"テキストを追加"]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var t;let s=null==(t=e.target.files)?void 0:t[0];if(!s)return;let a=new FileReader;a.onload=e=>{var t;let s=new Image;s.onload=()=>{let e=document.createElement("canvas"),t=s.width,a=s.height;if(t>800||a>800){let e=Math.min(800/t,800/a);t*=e,a*=e}e.width=t,e.height=a;let d=e.getContext("2d");null==d||d.drawImage(s,0,0,t,a),o(e.toDataURL("image/jpeg",.8),window.innerWidth/2-t/2,window.innerHeight/2-a/2,t,a),W.oR.success("画像を追加しました")},s.src=null==(t=e.target)?void 0:t.result},a.readAsDataURL(s),e.target.value=""},className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",title:"画像を追加"}),(0,a.jsxs)(m,{className:"w-full justify-start gap-2 bg-orange-50 hover:bg-orange-100 text-orange-700 border-orange-200 pointer-events-none",variant:"outline",children:[(0,a.jsx)(f.A,{className:"w-4 h-4"}),"画像を追加"]})]}),(0,a.jsxs)(y,{children:[(0,a.jsx)(k,{asChild:!0,children:(0,a.jsxs)(m,{className:"w-full justify-start gap-2 bg-emerald-50 hover:bg-emerald-100 text-emerald-700 border-emerald-200",variant:"outline",children:[(0,a.jsx)(b.A,{className:"w-4 h-4"}),"テンプレート"]})}),(0,a.jsxs)(I,{className:"w-56 max-h-[60vh] overflow-y-auto",children:[(0,a.jsx)(C,{onClick:()=>N("x"),children:"Xチャート (分類)"}),(0,a.jsx)(C,{onClick:()=>N("y"),children:"Yチャート (分類)"}),(0,a.jsx)(C,{onClick:()=>N("axis"),children:"座標軸 (順序付け)"}),(0,a.jsx)(C,{onClick:()=>N("venn"),children:"ベン図 (比較)"}),(0,a.jsx)(C,{onClick:()=>N("pmi"),children:"PMIチャート (分析)"}),(0,a.jsx)(C,{onClick:()=>N("kwl"),children:"KWLチャート (振り返り)"}),(0,a.jsx)(C,{onClick:()=>N("jellyfish"),children:"クラゲチャート (見通す)"}),(0,a.jsx)(C,{onClick:()=>N("fishbone"),children:"フィッシュボーン図 (構造化)"}),(0,a.jsx)(C,{onClick:()=>N("candy"),children:"キャンディーチャート (因果関係)"}),(0,a.jsx)(C,{onClick:()=>N("pyramid"),children:"ピラミッドチャート (焦点化)"})]})]})]})}),(0,a.jsxs)("div",{className:"mt-auto space-y-2 pt-4 border-t border-slate-100",children:[(0,a.jsxs)(m,{onClick:()=>{W.oR.info("画像書き出し機能は準備中です")},variant:"outline",className:"w-full justify-start gap-2",children:[(0,a.jsx)(j.A,{className:"w-4 h-4"}),"画像として保存"]}),(0,a.jsxs)(m,{onClick:()=>{u(!0)},variant:"ghost",className:"w-full justify-start gap-2 text-red-600 hover:text-red-700 hover:bg-red-50",children:[(0,a.jsx)(w.A,{className:"w-4 h-4"}),"すべて消去"]})]}),(0,a.jsx)(_,{open:c,onOpenChange:u,children:(0,a.jsxs)(P,{children:[(0,a.jsxs)(R,{children:[(0,a.jsx)(L,{children:"キャンバスをすべて消去しますか？"}),(0,a.jsx)(E,{children:"この操作は取り消せません。本当にキャンバスをリセットしますか？"})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-4 mt-4",children:[(0,a.jsx)(m,{variant:"outline",onClick:()=>u(!1),children:"キャンセル"}),(0,a.jsx)(m,{variant:"destructive",onClick:()=>{l(),u(!1),W.oR.success("キャンバスをリセットしました")},children:"すべて消去"})]})]})})]})}},7133:(e,t,s)=>{Promise.resolve().then(s.bind(s,7899)),Promise.resolve().then(s.bind(s,4685))},7899:(e,t,s)=>{"use strict";s.d(t,{default:()=>i});var a=s(5155);let d=(0,s(7909).default)(()=>Promise.all([s.e(413),s.e(283),s.e(286)]).then(s.bind(s,7286)),{loadableGenerated:{webpack:()=>[7286]},ssr:!1,loading:()=>(0,a.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-slate-50 text-slate-400",children:(0,a.jsxs)("div",{className:"animate-pulse flex flex-col items-center gap-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 border-4 border-blue-200 border-t-blue-500 rounded-full animate-spin"}),(0,a.jsx)("p",{children:"キャンバスを読み込み中..."})]})})});function i(){return(0,a.jsx)(d,{})}},9869:(e,t,s)=>{"use strict";s.d(t,{F:()=>n});var a=s(5959),d=s(9863),i=s(9675);let n=(0,a.v)()((0,d.Zr)(e=>({tool:"pointer",nodes:[],images:[],texts:[],templates:[],edges:[],selectedNodeIds:[],selectedTemplateIds:[],canvasScale:1,canvasPosition:{x:0,y:0},addNode:(t,s)=>e(e=>({nodes:[...e.nodes,{id:(0,i.A)(),x:t,y:s,text:"",color:"yellow",width:150,height:150}]})),updateNode:(t,s)=>e(e=>({nodes:e.nodes.map(e=>e.id===t?{...e,...s}:e)})),removeNode:t=>e(e=>({nodes:e.nodes.filter(e=>e.id!==t),edges:e.edges.filter(e=>e.sourceId!==t&&e.targetId!==t),selectedNodeIds:e.selectedNodeIds.filter(e=>e!==t)})),addImage:(t,s,a,d,n)=>e(e=>({images:[...e.images,{id:(0,i.A)(),src:t,x:s,y:a,width:d,height:n}]})),updateImage:(t,s)=>e(e=>({images:e.images.map(e=>e.id===t?{...e,...s}:e)})),removeImage:t=>e(e=>({images:e.images.filter(e=>e.id!==t),selectedNodeIds:e.selectedNodeIds.filter(e=>e!==t)})),addText:(t,s)=>e(e=>({texts:[...e.texts,{id:(0,i.A)(),x:t,y:s,text:"",fontSize:24,width:200}]})),updateText:(t,s)=>e(e=>({texts:e.texts.map(e=>e.id===t?{...e,...s}:e)})),removeText:t=>e(e=>({texts:e.texts.filter(e=>e.id!==t),selectedNodeIds:e.selectedNodeIds.filter(e=>e!==t)})),addConnectedNode:t=>e(e=>{let s=e.nodes.find(e=>e.id===t);if(!s)return e;let a=(0,i.A)(),d={id:a,x:s.x+s.width+50,y:s.y,text:"",color:s.color,width:s.width,height:s.height},n={id:(0,i.A)(),sourceId:t,targetId:a};return{nodes:[...e.nodes,d],edges:[...e.edges,n],selectedNodeIds:[a]}}),addTemplate:t=>e(e=>{let s=window.innerWidth,a=window.innerHeight,d=-e.canvasPosition.x/e.canvasScale+s/2/e.canvasScale-600,n=-e.canvasPosition.y/e.canvasScale+a/2/e.canvasScale-400;return{templates:[...e.templates,{id:(0,i.A)(),type:t,x:d,y:n,width:1200,height:800}]}}),removeTemplate:t=>e(e=>({templates:e.templates.filter(e=>e.id!==t),selectedTemplateIds:e.selectedTemplateIds.filter(e=>e!==t)})),updateTemplate:(t,s)=>e(e=>({templates:e.templates.map(e=>e.id===t?{...e,...s}:e)})),addEdge:(t,s)=>e(e=>({edges:[...e.edges,{id:(0,i.A)(),sourceId:t,targetId:s}]})),removeEdge:t=>e(e=>({edges:e.edges.filter(e=>e.id!==t)})),setSelectedNodes:t=>e({selectedNodeIds:t,selectedTemplateIds:[]}),setSelectedTemplates:t=>e({selectedTemplateIds:t,selectedNodeIds:[]}),setMultiSelection:(t,s)=>e({selectedNodeIds:t,selectedTemplateIds:s}),setCanvasTransform:(t,s)=>e({canvasScale:t,canvasPosition:s}),setTool:t=>e({tool:t}),moveSelectedNodes:(t,s,a)=>e(e=>{let d=d=>d.map(d=>(e.selectedNodeIds.includes(d.id)||e.selectedTemplateIds.includes(d.id))&&d.id!==a?{...d,x:d.x+t,y:d.y+s}:d);return{nodes:d(e.nodes),images:d(e.images),texts:d(e.texts),templates:d(e.templates)}}),resetCanvas:()=>e({tool:"pointer",nodes:[],images:[],texts:[],templates:[],edges:[],selectedNodeIds:[],selectedTemplateIds:[],canvasScale:1,canvasPosition:{x:0,y:0}})}),{name:"canvas-storage",partialize:e=>({nodes:e.nodes,images:e.images,texts:e.texts,templates:e.templates,edges:e.edges,canvasScale:e.canvasScale,canvasPosition:e.canvasPosition})}))}},e=>{e.O(0,[197,279,441,255,358],()=>e(e.s=7133)),_N_E=e.O()}]);